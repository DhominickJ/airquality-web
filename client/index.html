<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Air Quality by Cyb Org</title>
        <link rel="stylesheet" href="index.css" />
    </head>
    <body>
        <div class="global-container">
            <section class="main-display">
                <p class="date-time">Today | Saturday, January 12, 2024</p>
                <h2 class="location">Iloilo City</h2>
                <div class="aqi">
                    <h1>21</h1>
                    <p>AQI</p>
                </div>
                <h3 class="quality-indicator">Excellent</h3>
                <p class="description">
                    The air quality is generally acceptable for most
                    individuals. However, sensitive groups may experience minor
                    to moderate symptoms from long term exposure.
                </p>
            </section>

            <section class="other-stats">
                <div class="stat">
                    <p>Temperature</p>
                    <h3 id="stat-temperature">24°</h3>
                </div>
                <hr />
                <div class="stat">
                    <p>Humidity</p>
                    <h3 id="stat-humidity">86</h3>
                </div>
                <hr />
                <!-- <div class="stat">
                    <p>Carbon Monoxide</p>
                    <h3>24</h3>
                </div> -->
                <div class="stat">
                    <p>Flammable Gas Content</p>
                    <h3 id="stat-gascontent">24</h3>
                </div>
                <hr />
                <div class="stat">
                    <p>Particulates</p>
                    <h3>58</h3>
                </div>
            </section>

            <footer>
                <svg class="icon"></svg>
                <h2>Air Quality</h2>
                <p>by Cyb Robotics</p>
            </footer>
        </div>

        <script>
            // Connect to the WebSocket channel for the browser
            const socket = new WebSocket("ws://127.0.0.1:1337/browser");

            socket.addEventListener("open", (event) => {
                console.log("Connected to WebSocket channel for the browser");
            });

            socket.addEventListener("message", (msg) => {
                const sensors = JSON.parse(msg["data"]);

                sensors.forEach((sensor) => {
                    console.log(
                        `Temperature: ${sensor.temperature}°C\nHumidity: ${sensor.humidity}g/kg\nGas Concentration: ${sensor.gasConcentration}ppm`
                    );

                    document.querySelector('#stat-temperature').innerHTML = `${Math.round(sensor.temperature)}°`;
                    document.querySelector('#stat-humidity').innerHTML = `${Math.round(sensor.humidity)}`;
                    document.querySelector('#stat-gascontent').innerHTML = `${Math.round(sensor.gasConcentration)}`;
                });
            });

            socket.addEventListener("close", (event) => {});
        </script>
    </body>
</html>
